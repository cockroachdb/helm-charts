{{- if .Values.init.database.enabled }}
apiVersion: v1
kind: Secret
metadata:
  name: {{ template "cockroachdb.fullname" . }}-init
type: Opaque
stringData:
{{- if .Values.init.database }}

{{- range $user := .Values.init.database.users }}
{{- if $user.password }}
  {{ $user.name }}-password: {{ $user.password }}
{{- end }}
{{- end }}

{{- range $clusterSetting, $clusterSettingValue := .Values.init.database.clusterSettings }}
{{- if $clusterSetting }}
  {{ $clusterSetting }}-cluster-setting: {{ $clusterSettingValue }}
{{- end }}
{{- end }}

{{- end }}
